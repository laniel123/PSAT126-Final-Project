"0","bestmodel <- lm(log(price) ~ carat + depth + table + color + cut + clarity, data = sample_df)"
"0","summary(bestmodel)"
"1","
Call:
"
"1",""
"1","lm(formula = log(price) ~ carat + depth + table + color + cut + 
    clarity, data = sample_df)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-1.77887 "
"1","-0.19978 "
"1"," 0.05101 "
"1"," 0.22326 "
"1"," 0.80092 "
"1","
"
"1","
Coefficients:
"
"1","            "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept) "
"1","  3.500615"
"1","   1.164762"
"1","   3.005"
"1","  0.00279"
"1"," ** "
"1","
carat       "
"1","  2.217139"
"1","   0.036143"
"1","  61.343"
"1","  < 2e-16"
"1"," ***"
"1","
depth       "
"1","  0.028203"
"1","   0.013198"
"1","   2.137"
"1","  0.03310"
"1"," *  "
"1","
table       "
"1"," -0.007769"
"1","   0.009534"
"1","  -0.815"
"1","  0.41551"
"1","    "
"1","
colorE      "
"1"," -0.045015"
"1","   0.056615"
"1","  -0.795"
"1","  0.42694"
"1","    "
"1","
colorF      "
"1","  0.010798"
"1","   0.057067"
"1","   0.189"
"1","  0.85000"
"1","    "
"1","
colorG      "
"1"," -0.090524"
"1","   0.054586"
"1","  -1.658"
"1","  0.09790"
"1"," .  "
"1","
colorH      "
"1"," -0.212145"
"1","   0.057490"
"1","  -3.690"
"1","  0.00025"
"1"," ***"
"1","
colorI      "
"1"," -0.451494"
"1","   0.062719"
"1","  -7.199"
"1"," 2.37e-12"
"1"," ***"
"1","
colorJ      "
"1"," -0.380062"
"1","   0.081839"
"1","  -4.644"
"1"," 4.42e-06"
"1"," ***"
"1","
cutGood     "
"1","  0.207604"
"1","   0.105644"
"1","   1.965"
"1","  0.04998"
"1"," *  "
"1","
cutIdeal    "
"1","  0.208290"
"1","   0.101938"
"1","   2.043"
"1","  0.04157"
"1"," *  "
"1","
cutPremium  "
"1","  0.191020"
"1","   0.099698"
"1","   1.916"
"1","  0.05596"
"1"," .  "
"1","
cutVery Good"
"1","  0.171059"
"1","   0.099499"
"1","   1.719"
"1","  0.08622"
"1"," .  "
"1","
clarityIF   "
"1","  1.541263"
"1","   0.190415"
"1","   8.094"
"1"," 4.79e-15"
"1"," ***"
"1","
claritySI1  "
"1","  1.136220"
"1","   0.172848"
"1","   6.574"
"1"," 1.29e-10"
"1"," ***"
"1","
claritySI2  "
"1","  0.957326"
"1","   0.171872"
"1","   5.570"
"1"," 4.25e-08"
"1"," ***"
"1","
clarityVS1  "
"1","  1.293815"
"1","   0.174882"
"1","   7.398"
"1"," 6.23e-13"
"1"," ***"
"1","
clarityVS2  "
"1","  1.229676"
"1","   0.171928"
"1","   7.152"
"1"," 3.21e-12"
"1"," ***"
"1","
clarityVVS1 "
"1","  1.284112"
"1","   0.181152"
"1","   7.089"
"1"," 4.88e-12"
"1"," ***"
"1","
clarityVVS2 "
"1","  1.378685"
"1","   0.178530"
"1","   7.722"
"1"," 6.72e-14"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.3242"
"1"," "
"1","on"
"1"," "
"1","479"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.9002"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.8961"
"1"," "
"1","
F-statistic:"
"1"," "
"1","216.1"
"1"," "
"1","on"
"1"," "
"1","20"
"1"," "
"1","and"
"1"," "
"1","479"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"0","# Now applying AIC/BIC, and VIF and checking assumptions of model"
"0","AIC(bestmodel)"
"1","[1]"
"1"," 315.2053"
"1","
"
"0","BIC(bestmodel)"
"1","[1]"
"1"," 407.9267"
"1","
"
"0","library(car)"
"0","vif(bestmodel)"
"1","       "
"1","     GVIF"
"1"," Df"
"1"," GVIF^(1/(2*Df))"
"1","
carat  "
"1"," 1.360832"
"1","  1"
"1","        1.166547"
"1","
depth  "
"1"," 1.488309"
"1","  1"
"1","        1.219963"
"1","
table  "
"1"," 2.007385"
"1","  1"
"1","        1.416822"
"1","
color  "
"1"," 1.356200"
"1","  6"
"1","        1.025716"
"1","
cut    "
"1"," 2.371372"
"1","  4"
"1","        1.113974"
"1","
clarity"
"1"," 1.622218"
"1","  7"
"1","        1.035161"
"1","
"
"0","confint(bestmodel)"
"1","            "
"1","         2.5 %"
"1","      97.5 %"
"1","
(Intercept) "
"1","  1.211940e+00"
"1","  5.78929006"
"1","
carat       "
"1","  2.146119e+00"
"1","  2.28815793"
"1","
depth       "
"1","  2.270908e-03"
"1","  0.05413554"
"1","
table       "
"1"," -2.650247e-02"
"1","  0.01096359"
"1","
colorE      "
"1"," -1.562585e-01"
"1","  0.06622854"
"1","
colorF      "
"1"," -1.013338e-01"
"1","  0.12292967"
"1","
colorG      "
"1"," -1.977819e-01"
"1","  0.01673366"
"1","
colorH      "
"1"," -3.251081e-01"
"1"," -0.09918093"
"1","
colorI      "
"1"," -5.747334e-01"
"1"," -0.32825533"
"1","
colorJ      "
"1"," -5.408697e-01"
"1"," -0.21925378"
"1","
cutGood     "
"1","  2.090368e-05"
"1","  0.41518686"
"1","
cutIdeal    "
"1","  7.989141e-03"
"1","  0.40859000"
"1","
cutPremium  "
"1"," -4.879499e-03"
"1","  0.38692017"
"1","
cutVery Good"
"1"," -2.444959e-02"
"1","  0.36656786"
"1","
clarityIF   "
"1","  1.167111e+00"
"1","  1.91541584"
"1","
claritySI1  "
"1","  7.965849e-01"
"1","  1.47585485"
"1","
claritySI2  "
"1","  6.196097e-01"
"1","  1.29504143"
"1","
clarityVS1  "
"1","  9.501839e-01"
"1","  1.63744590"
"1","
clarityVS2  "
"1","  8.918494e-01"
"1","  1.56750171"
"1","
clarityVVS1 "
"1","  9.281611e-01"
"1","  1.64006315"
"1","
clarityVVS2 "
"1","  1.027885e+00"
"1","  1.72948453"
"1","
"
"0","new_obs <- data.frame(carat = 1, depth = 61, table = 57, color = ""G"", cut = ""Ideal"", clarity = ""VS2"")"
"0","predict(bestmodel, newdata = new_obs, interval = ""confidence"")"
"1"," "
"1","      fit"
"1","      lwr"
"1","      upr"
"1","
1"
"1"," 8.342733"
"1"," 8.249651"
"1"," 8.435815"
"1","
"
"0","predict(bestmodel, newdata = new_obs, interval = ""prediction"")"
"1"," "
"1","      fit"
"1","      lwr"
"1","    upr"
"1","
1"
"1"," 8.342733"
"1"," 7.698866"
"1"," 8.9866"
"1","
"
"0","par(mfrow = c(2,2))"
"0","plot(bestmodel)"
